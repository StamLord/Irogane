[gd_scene load_steps=24 format=3 uid="uid://rudwdswtudgx"]

[ext_resource type="Script" path="res://scripts/interactive/Pickup.gd" id="1_ukb7u"]
[ext_resource type="Material" uid="uid://cnv52hl6lnudl" path="res://assets/materials/candle.tres" id="2_j45sb"]
[ext_resource type="Script" path="res://scripts/vfx/omnilight_flicker.gd" id="3_2vpnk"]
[ext_resource type="Script" path="res://scripts/procedural/igniter.gd" id="4_p2gxg"]
[ext_resource type="Texture2D" uid="uid://dic5cwk3icpv6" path="res://assets/textures/vfx/candle.png" id="5_83t7i"]
[ext_resource type="Script" path="res://scripts/procedural/ignitable.gd" id="6_mk7ei"]

[sub_resource type="BoxShape3D" id="BoxShape3D_qo1wx"]
size = Vector3(0.15, 0.3, 0.15)

[sub_resource type="BoxShape3D" id="BoxShape3D_76ii7"]
size = Vector3(0.1, 0.3, 0.1)

[sub_resource type="CylinderMesh" id="CylinderMesh_uws5e"]
top_radius = 0.03
bottom_radius = 0.03
height = 0.25
radial_segments = 4
rings = 1

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_eyu57"]
shading_mode = 0
albedo_color = Color(1, 0.784314, 0, 1)

[sub_resource type="SphereShape3D" id="SphereShape3D_kpleh"]
radius = 0.2

[sub_resource type="Curve" id="Curve_wrjpo"]
_data = [Vector2(0, 1), 0.0, -0.445115, 0, 0, Vector2(1, 0), -1.62068, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_x2yda"]
curve = SubResource("Curve_wrjpo")

[sub_resource type="Gradient" id="Gradient_so47k"]
offsets = PackedFloat32Array(0, 0.237705, 0.561475)
colors = PackedColorArray(1, 0.968002, 0.431428, 1, 0.912296, 0.771426, 0, 1, 0.77192, 0.22088, 0, 1)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_2kkno"]
gradient = SubResource("Gradient_so47k")

[sub_resource type="Curve" id="Curve_db5i3"]
_data = [Vector2(0, 0), 0.0, 3.43082, 0, 0, Vector2(1, 1), 0.0, 0.178046, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_pbwux"]
curve = SubResource("Curve_db5i3")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_dspaw"]
emission_shape_scale = Vector3(1, 1, 0.01)
angle_min = -1.0
angle_max = 1.0
gravity = Vector3(0, 0, 0)
scale_min = 0.23
scale_max = 0.25
scale_curve = SubResource("CurveTexture_pbwux")
color_ramp = SubResource("GradientTexture1D_2kkno")
alpha_curve = SubResource("CurveTexture_x2yda")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_stvex"]
transparency = 1
blend_mode = 1
shading_mode = 0
vertex_color_use_as_albedo = true
albedo_texture = ExtResource("5_83t7i")
billboard_mode = 3
billboard_keep_scale = true
particles_anim_h_frames = 1
particles_anim_v_frames = 1
particles_anim_loop = false

[sub_resource type="QuadMesh" id="QuadMesh_2jelb"]
material = SubResource("StandardMaterial3D_stvex")
center_offset = Vector3(0, 0.15, 0)

[sub_resource type="SphereShape3D" id="SphereShape3D_s5tgw"]
radius = 0.2

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_17cjj"]
albedo_color = Color(0.341176, 0.192157, 0.0823529, 1)

[sub_resource type="BoxMesh" id="BoxMesh_73pxo"]
size = Vector3(0.007, 0.075, 0.007)

[node name="candle_tool_pickup" type="RigidBody3D"]

[node name="interactive_area" type="Area3D" parent="." node_paths=PackedStringArray("mesh")]
collision_layer = 4
collision_mask = 4
script = ExtResource("1_ukb7u")
item_id = "candle_tool"
mesh = NodePath("../candle_object")

[node name="CollisionShape3D" type="CollisionShape3D" parent="interactive_area"]
shape = SubResource("BoxShape3D_qo1wx")

[node name="collider" type="CollisionShape3D" parent="."]
shape = SubResource("BoxShape3D_76ii7")

[node name="candle_object" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 0.999999, 0, 0, 0)
cast_shadow = 0
mesh = SubResource("CylinderMesh_uws5e")
skeleton = NodePath("")
surface_material_override/0 = ExtResource("2_j45sb")

[node name="MeshInstance3D" type="MeshInstance3D" parent="candle_object"]
transform = Transform3D(1, 1.49012e-08, 0, 2.98023e-08, 1, -2.98023e-08, 0, -2.98023e-08, 1, 0.0324404, 0.153458, 0)
material_override = SubResource("StandardMaterial3D_eyu57")

[node name="light" type="OmniLight3D" parent="candle_object/MeshInstance3D" groups=["light_source"]]
transform = Transform3D(1, 2.23517e-07, -1.78814e-07, 2.98023e-08, 1, 3.27826e-07, -8.9407e-08, -2.98023e-08, 1, 0, 0, 0)
visible = false
light_color = Color(1, 0.54902, 0, 1)
light_energy = 0.5
shadow_enabled = true
omni_range = 3.0
omni_attenuation = 2.0
script = ExtResource("3_2vpnk")
base_energy = 0.5
flicker_amount = 4.0

[node name="igniter_area" type="Area3D" parent="candle_object/MeshInstance3D/light"]
transform = Transform3D(1, -2.68221e-07, 1.49012e-07, 7.45058e-08, 1, -2.08616e-07, 8.9407e-08, -2.98023e-08, 1, 0, 0, 0)
collision_layer = 2048
collision_mask = 2048
script = ExtResource("4_p2gxg")

[node name="CollisionShape3D" type="CollisionShape3D" parent="candle_object/MeshInstance3D/light/igniter_area"]
shape = SubResource("SphereShape3D_kpleh")

[node name="GPUParticles3D" type="GPUParticles3D" parent="candle_object/MeshInstance3D/light"]
transform = Transform3D(1, -2.38419e-07, 1.49012e-07, 8.9407e-08, 0.999998, -8.9407e-08, 8.9407e-08, 8.9407e-08, 1, 0, 0, 0)
amount = 16
lifetime = 0.2
fixed_fps = 60
local_coords = true
process_material = SubResource("ParticleProcessMaterial_dspaw")
draw_pass_1 = SubResource("QuadMesh_2jelb")

[node name="ignitable_area" type="Area3D" parent="candle_object/MeshInstance3D"]
transform = Transform3D(1, 0, 0, 2.98023e-08, 1, 0, 0, 0, 1, 0, 0, 0)
collision_layer = 2048
collision_mask = 2048
script = ExtResource("6_mk7ei")

[node name="CollisionShape3D" type="CollisionShape3D" parent="candle_object/MeshInstance3D/ignitable_area"]
shape = SubResource("SphereShape3D_s5tgw")

[node name="MeshInstance3D2" type="MeshInstance3D" parent="candle_object"]
transform = Transform3D(0.681871, 0.731473, 0, -0.731473, 0.681871, -2.98023e-08, 2.98023e-08, -9.12696e-08, 1, 0.0140285, 0.140245, 1.19209e-07)
material_override = SubResource("StandardMaterial3D_17cjj")
mesh = SubResource("BoxMesh_73pxo")
