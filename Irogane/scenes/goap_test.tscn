[gd_scene load_steps=16 format=3 uid="uid://bu4kjhwhvheym"]

[ext_resource type="PackedScene" uid="uid://bx4y44rdruyi7" path="res://prefabs/entities/player.tscn" id="1_66hyo"]
[ext_resource type="Texture2D" uid="uid://tox4b5jwaog1" path="res://assets/hdris/kloofendal_48d_partly_cloudy_puresky_2k.hdr" id="2_c72l7"]
[ext_resource type="Texture2D" uid="uid://tj58eaqcflda" path="res://assets/textures/dev/grids/grid_64x64_dark_2.png" id="3_3d6s4"]
[ext_resource type="PackedScene" uid="uid://6w2qvvdo2jh4" path="res://prefabs/entities/enemy_goap.tscn" id="3_7nk2a"]
[ext_resource type="Script" path="res://scripts/ai/schedule_agent.gd" id="4_kxrqv"]
[ext_resource type="Resource" uid="uid://ubsldkvqa64y" path="res://data/ai_agents/Civilian.res" id="5_pyu6k"]
[ext_resource type="Script" path="res://scripts/interactive/LightSwitch.gd" id="7_wd2ec"]

[sub_resource type="PanoramaSkyMaterial" id="PanoramaSkyMaterial_twibi"]
panorama = ExtResource("2_c72l7")

[sub_resource type="Sky" id="Sky_7a7j5"]
sky_material = SubResource("PanoramaSkyMaterial_twibi")

[sub_resource type="Environment" id="Environment_dc3xh"]
background_mode = 2
sky = SubResource("Sky_7a7j5")
ambient_light_sky_contribution = 0.5
tonemap_mode = 2
glow_enabled = true
fog_density = 0.2
volumetric_fog_density = 0.03

[sub_resource type="NavigationMesh" id="NavigationMesh_cljca"]
vertices = PackedVector3Array(-5.60375, 0.486027, 2.223, -4.10375, 0.486027, 2.223, -4.35375, 0.486027, -12.027, -6.10375, 0.486027, 3.723, -5.60375, 0.486027, 2.223, -4.35375, 0.486027, -12.027, -28.1038, 0.486027, -12.027, -28.1038, 0.486027, 3.723, 3.64625, 0.486027, 1.473, 3.39625, 0.486027, -12.027, -4.35375, 0.486027, -12.027, -4.10375, 0.486027, 2.223, 13.3962, 0.486027, 0.223, 12.8962, 0.486027, -12.027, 3.39625, 0.486027, -12.027, 3.64625, 0.486027, 1.473, 14.6462, 0.486027, 2.223, 13.6462, 0.486027, 2.723, 14.1462, 0.486027, 10.473, 18.1462, 0.486027, 9.973, 18.1462, 0.486027, 9.973, 18.3962, 0.486027, 11.223, 48.6462, 0.486027, 11.223, 14.6462, 0.486027, 0.723, 14.6462, 0.486027, 2.223, 18.1462, 0.486027, 9.973, 12.8962, 0.486027, -12.027, 13.3962, 0.486027, 0.223, 14.6462, 0.486027, 0.723, 12.8962, 0.486027, -12.027, 14.6462, 0.486027, 0.723, 18.1462, 0.486027, 9.973, 48.6462, 0.486027, 11.223, 48.6462, 0.486027, -12.027, 5.39625, 0.486027, 3.473, 5.89625, 0.486027, 12.223, 14.1462, 0.486027, 10.473, 13.6462, 0.486027, 2.723, -1.35375, 0.486027, 4.223, -1.10375, 0.486027, 13.723, 5.89625, 0.486027, 12.223, 5.39625, 0.486027, 3.473, -2.10375, 0.486027, 14.223, -1.10375, 0.486027, 13.723, -1.35375, 0.486027, 4.223, -5.85375, 0.486027, 4.723, -5.85375, 0.486027, 4.723, -6.10375, 0.486027, 3.723, -28.1038, 0.486027, 3.723, -2.10375, 0.486027, 14.973, -2.10375, 0.486027, 14.223, -5.85375, 0.486027, 4.723, -28.1038, 0.486027, 3.723, -28.1038, 0.486027, 14.973, -1.60375, 0.486027, 16.223, -2.10375, 0.486027, 14.973, -28.1038, 0.486027, 14.973, -28.1038, 0.486027, 232.223, 48.6462, 0.486027, 11.223, 18.3962, 0.486027, 11.223, 18.1462, 0.486027, 12.223, 48.6462, 0.486027, 11.223, 18.1462, 0.486027, 12.223, -0.10375, 0.486027, 16.223, -28.1038, 0.486027, 232.223, 48.6462, 0.486027, 232.223, -0.10375, 0.486027, 16.223, -1.60375, 0.486027, 16.223, -28.1038, 0.486027, 232.223)
polygons = [PackedInt32Array(2, 1, 0), PackedInt32Array(4, 3, 5), PackedInt32Array(5, 3, 7), PackedInt32Array(5, 7, 6), PackedInt32Array(9, 8, 10), PackedInt32Array(10, 8, 11), PackedInt32Array(13, 12, 14), PackedInt32Array(14, 12, 15), PackedInt32Array(17, 16, 18), PackedInt32Array(18, 16, 19), PackedInt32Array(22, 21, 20), PackedInt32Array(25, 24, 23), PackedInt32Array(28, 27, 26), PackedInt32Array(30, 29, 31), PackedInt32Array(31, 29, 32), PackedInt32Array(32, 29, 33), PackedInt32Array(37, 36, 34), PackedInt32Array(34, 36, 35), PackedInt32Array(41, 40, 38), PackedInt32Array(38, 40, 39), PackedInt32Array(43, 42, 44), PackedInt32Array(44, 42, 45), PackedInt32Array(48, 47, 46), PackedInt32Array(50, 49, 51), PackedInt32Array(51, 49, 53), PackedInt32Array(51, 53, 52), PackedInt32Array(55, 54, 56), PackedInt32Array(56, 54, 57), PackedInt32Array(60, 59, 58), PackedInt32Array(62, 61, 63), PackedInt32Array(63, 61, 65), PackedInt32Array(63, 65, 64), PackedInt32Array(68, 67, 66)]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_tn2ew"]
albedo_texture = ExtResource("3_3d6s4")
uv1_scale = Vector3(0.5, 0.5, 0.5)
uv1_triplanar = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_pvfsj"]
albedo_texture = ExtResource("3_3d6s4")
uv1_scale = Vector3(0.5, 0.5, 0.5)
uv1_triplanar = true
texture_filter = 0

[sub_resource type="BoxShape3D" id="BoxShape3D_s7ost"]
size = Vector3(0.2, 0.4, 0.2)

[sub_resource type="CylinderMesh" id="CylinderMesh_olraa"]
top_radius = 0.05
bottom_radius = 0.05
height = 0.4

[node name="GoapTest" type="Node3D"]

[node name="player" parent="." instance=ExtResource("1_66hyo")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.48337, 0)

[node name="env" type="Node3D" parent="."]

[node name="WorldEnvironment2" type="WorldEnvironment" parent="env"]
environment = SubResource("Environment_dc3xh")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="env" groups=["light_source"]]
transform = Transform3D(-0.866025, -0.433013, 0.25, 0, 0.5, 0.866025, -0.5, 0.75, -0.433013, 0, 0, 0)
light_energy = 0.1
shadow_enabled = true

[node name="npc" parent="." instance=ExtResource("3_7nk2a")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0631526, 24.3815)

[node name="ScheduleAgent" type="Node3D" parent="npc"]
script = ExtResource("4_kxrqv")
schedule = {
"22:00": {
"location": ["guard_a", "guard_b"],
"task_type": 3
}
}

[node name="npc2" parent="." instance=ExtResource("3_7nk2a")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -11, 0.0631526, 27.8815)
agent_data = ExtResource("5_pyu6k")

[node name="ScheduleAgent" type="Node3D" parent="npc2"]
script = ExtResource("4_kxrqv")
schedule = {
"22:00": {
"location": ["civilian_a", "civilian_b"],
"task_type": 0
}
}

[node name="world" type="Node3D" parent="."]

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="world"]
navigation_mesh = SubResource("NavigationMesh_cljca")

[node name="CSGBox3D" type="CSGBox3D" parent="world/NavigationRegion3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 10.3332, -0.226741, 110.11)
material_override = SubResource("StandardMaterial3D_tn2ew")
use_collision = true
size = Vector3(77.8739, 0.574463, 245.274)

[node name="wall3" type="CSGBox3D" parent="world/NavigationRegion3D"]
transform = Transform3D(0.994349, 0, 0.10616, 0, 1, 0, -0.10616, 0, 0.994349, 4.24988, 1.52588, 2.46734)
use_collision = true
size = Vector3(19.479, 3, 1)
material = SubResource("StandardMaterial3D_pvfsj")

[node name="wall3" type="CSGBox3D" parent="world/NavigationRegion3D/wall3"]
transform = Transform3D(0.99435, 0, 0.10616, 0, 1, 0, -0.10616, 0, 0.99435, 2.83473, 0.0440435, 10.9489)
use_collision = true
size = Vector3(19.479, 3, 1)
material = SubResource("StandardMaterial3D_pvfsj")

[node name="markers" type="Node3D" parent="."]
unique_name_in_owner = true

[node name="guard_a" type="Marker3D" parent="markers"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 24.5)

[node name="guard_b" type="Marker3D" parent="markers"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 12.5, 0, 24.5)

[node name="civilian_a" type="Marker3D" parent="markers"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -11, 0, 24.5)

[node name="civilian_b" type="Marker3D" parent="markers"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -11, 0, 8)

[node name="LightSwitch" type="Area3D" parent="." node_paths=PackedStringArray("light")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -5, 1, 9)
collision_layer = 4
collision_mask = 4
script = ExtResource("7_wd2ec")
light = NodePath("OmniLight3D")
_animate_position = false
_animate_rotation = false

[node name="OmniLight3D" type="OmniLight3D" parent="LightSwitch" groups=["light_source"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.323846, 0)
visible = false
light_color = Color(1, 1, 0, 1)
light_energy = 10.0

[node name="CollisionShape3D" type="CollisionShape3D" parent="LightSwitch"]
shape = SubResource("BoxShape3D_s7ost")

[node name="MeshInstance3D" type="MeshInstance3D" parent="LightSwitch"]
mesh = SubResource("CylinderMesh_olraa")

[node name="LightSwitch2" type="Area3D" parent="." node_paths=PackedStringArray("light")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -5, 1, 12)
collision_layer = 4
collision_mask = 4
script = ExtResource("7_wd2ec")
light = NodePath("OmniLight3D")
_animate_position = false
_animate_rotation = false

[node name="OmniLight3D" type="OmniLight3D" parent="LightSwitch2" groups=["light_source"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.323846, 0)
visible = false
light_color = Color(1, 1, 0, 1)
light_energy = 10.0

[node name="CollisionShape3D" type="CollisionShape3D" parent="LightSwitch2"]
shape = SubResource("BoxShape3D_s7ost")

[node name="MeshInstance3D" type="MeshInstance3D" parent="LightSwitch2"]
mesh = SubResource("CylinderMesh_olraa")
